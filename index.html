<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <title>Nav</title>
    <script type="module" src="https://unpkg.com/@ionic/core@4.6.0/dist/ionic/ionic.esm.js"></script>
    <script nomodule src="https://unpkg.com/@ionic/core@4.6.0/dist/ionic/ionic.js"></script>
    <link href="https://unpkg.com/@ionic/core@4.6.0/css/ionic.bundle.css" rel="stylesheet">
    <style>
        :root {
            --ion-safe-area-top: 20px;
            --ion-safe-area-bottom: 22px;
        }
    </style>
</head>
<body>
<ion-app>
    <ion-nav root="nav-home"></ion-nav>
</ion-app>

<script>
    window.onload=function () {
        document.addEventListener('touchstart',function (event) {
            if(event.touches.length>1){
                event.preventDefault();
            }
        });
        var lastTouchEnd=0;
        document.addEventListener('touchend',function (event) {
            var now=(new Date()).getTime();
            if(now-lastTouchEnd<=300){
                event.preventDefault();
            }
            lastTouchEnd=now;
        },false);
        document.addEventListener('gesturestart', function (event) {
            event.preventDefault();
        });
    }

    techs = [
        {
            'title': 'Angular',
            'icon': 'angular',
            'description': 'A powerful Javascript framework for building single page apps. Angular is open source, and maintained by Google.',
            'color': '#E63135'
        },
        {
            'title': 'CSS3',
            'icon': 'css3',
            'description': 'The latest version of cascading stylesheets - the styling language of the web!',
            'color': '#0CA9EA'
        },
        {
            'title': 'HTML5',
            'icon': 'html5',
            'description': 'The latest version of the web\'s markup language.',
            'color': '#F46529'
        },
        {
            'title': 'JavaScript',
            'icon': 'javascript',
            'description': 'One of the most popular programming languages on the Web!',
            'color': '#FFD439'
        },
        {
            'title': 'Sass',
            'icon': 'sass',
            'description': 'Syntactically Awesome Stylesheets - a mature, stable, and powerful professional grade CSS extension.',
            'color': '#CE6296'
        },
        {
            'title': 'NodeJS',
            'icon': 'nodejs',
            'description': 'An open-source, cross-platform runtime environment for developing server-side Web applications.',
            'color': '#78BD43'
        },
        {
            'title': 'Python',
            'icon': 'python',
            'description': 'A clear and powerful object-oriented programming language!',
            'color': '#3575AC'
        },
        {
            'title': 'Markdown',
            'icon': 'markdown',
            'description': 'A super simple way to add formatting like headers, bold, bulleted lists, and so on to plain text.',
            'color': '#412159'
        },
        {
            'title': 'Tux',
            'icon': 'tux',
            'description': 'The official mascot of the Linux kernel!',
            'color': '#000'
        },
    ];

    customElements.define('nav-home', class NavHome extends HTMLElement {
        connectedCallback() {
            this.innerHTML = `
          <ion-header translucent>
            <ion-toolbar>
              <ion-title>密码</ion-title>
            </ion-toolbar>
            <ion-toolbar>
              <ion-searchbar placeholder="搜索"></ion-searchbar>
            </ion-toolbar>
          </ion-header>
          <ion-content fullscreen>
            <ion-list>
            ${techs.map(tech => `
                <ion-item button onclick="showDetail('${tech.title}')">
                  <ion-icon slot="start" name="lock" style="color: #E63135;"></ion-icon>
                  <ion-label>
                    <h3>${tech.title}</h3>
                  </ion-label>
                </ion-item>
            `).join('\n')}
            </ion-list>
          </ion-content>
        `;
            const searchbar = document.querySelector('ion-searchbar');

            searchbar.addEventListener('ionInput', handleInput);
        }
    });
    const nav = document.querySelector('ion-nav');

    function showDetail(title) {
        const tech = techs.find(tech => tech.title === title);
        nav.push('nav-detail', { tech });
    }

    customElements.define('nav-detail', class NavDetail extends HTMLElement {
        connectedCallback() {
            this.innerHTML = `
          <ion-header translucent>
            <ion-toolbar>
              <ion-buttons slot="start">
                <ion-back-button defaultHref="/"></ion-back-button>
              </ion-buttons>
              <ion-title>${this.tech.title}</ion-title>
            </ion-toolbar>
          </ion-header>
          <ion-content fullscreen class="ion-padding">
            <ion-icon name="logo-${this.tech.icon}" style="color: ${this.tech.color};" size="large"></ion-icon>
            <p>${this.tech.description}</p>
          </ion-content>
        `;
        }
    });



    function handleInput(event) {
        const items = Array.from(document.querySelector('ion-list').children);
        const query = event.target.value.toLowerCase();
        requestAnimationFrame(() => {
            items.forEach(item => {
                const shouldShow = item.textContent.toLowerCase().indexOf(query) > -1;
                item.style.display = shouldShow ? 'block' : 'none';
            });
        });
    }
</script>
</body>
</html>
